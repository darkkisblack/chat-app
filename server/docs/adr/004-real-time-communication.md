# ADR 004: Real-time чат

## Статус
Принято

## Проблема
Нужен real-time обмен сообщениями. Polling не подходит.

## Решение
Socket.io поверх WebSocket

## Как работает
- WebSocket как основной транспорт
- HTTP Long Polling как fallback
- Room-based группировка
- Event-driven архитектура

## События
```javascript
// Клиент -> Сервер
'send_message'     // Отправка сообщения
'join_room'        // Присоединение к комнате
'leave_room'       // Выход из комнаты
'typing'           // Индикатор печати

// Сервер -> Клиент
'message_received' // Новое сообщение
'user_joined'      // Пользователь присоединился
'user_left'        // Пользователь вышел
'user_typing'      // Кто-то печатает
```

## Почему Socket.io
- Автоматический fallback
- Встроенная поддержка комнат
- Событийная архитектура
- Хорошая документация

## Что отверг
- Pure WebSocket - сложнее реализовать fallback
- Server-Sent Events - только one-way
- Polling - неэффективно

## Минусы
- Сложнее отлаживать
- Нужно обрабатывать переподключения
- Но это стандартные проблемы real-time 